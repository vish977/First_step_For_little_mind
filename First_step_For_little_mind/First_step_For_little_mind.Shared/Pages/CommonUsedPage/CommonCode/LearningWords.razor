@page "/Learn/{letter}"
@inject IJSRuntime JS
@using First_step_For_little_mind.Shared.List;

<div class="container-fluid">
	<div class="container text-center">

		<!-- Image or Message in FSLM-WordImg -->
		<div class="FSLM-WordImg d-flex justify-content-center align-items-center" style="height: 300px;">
			@if (currentIndex < selectedWords.Count)
			{
				<img src="@GetImagePath(selectedWords[currentIndex])" alt="Image of @selectedWords[currentIndex]" />
			}
			else
			{
				<div class="FSLM-Word" style="font-size: 24px; color: green;">
					Great job! Lets do some practices.
				</div>
			}
		</div>

		<!-- Word Spelling with Colored Letters -->
		@if (currentIndex < selectedWords.Count)
		{
			<div class="FSLM-Word mt-3">
				@foreach (var (ch, index) in selectedWords[currentIndex].Select((c, i) => (c, i)))
				{
					<span class="color-@(@index % 7)">@ch</span>
				}
			</div>
		}

		<!-- Navigation Buttons -->
		<div class="Button mt-4">
			<button class="btn btn-primary" @onclick="ShowPreviousWord" disabled="@(currentIndex == 0)">Previous</button>
			<button class="btn btn-primary ms-2" @onclick="ShowNextWord">Next</button>
		</div>
	</div>
</div>

@code {
	[Parameter]
	public string? letter { get; set; }

	private List<string> selectedWords = new();
	private int currentIndex = 0;

	protected override void OnParametersSet()
	{
		List<string> sourceList = new();

		if (letter?.ToLower() == "threeletterword")
		{
			sourceList = RequiredList.ThreeLetterWords;
		}
		else if (letter?.ToLower() == "fourletterword")
		{
			sourceList = RequiredList.FourLetterWords;
		}

		if (sourceList.Count > 0)
		{
			selectedWords = sourceList.OrderBy(x => Guid.NewGuid()).Take(10).ToList(); // Randomly pick 10
			currentIndex = 0;
		}
		else
		{
			selectedWords = new() { "Word Not Found" };
		}
	}

	private void ShowNextWord()
	{
		if (currentIndex < selectedWords.Count)
		{
			currentIndex++;
		}
	}

	private void ShowPreviousWord()
	{
		if (currentIndex > 0)
		{
			currentIndex--;
		}
	}

	private string GetImagePath(string word)
	{
		return $"_content/First_step_For_little_mind.shared/WordsLearning/{word}.jpg";
	}

	// Practice code
	

}
